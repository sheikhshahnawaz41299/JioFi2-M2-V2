<!-- <html xmlns="http://www.w3.org/1999/xhtml" >
<head>
<title>Engineer</title>
-->

	<!-- </head> -->

	    <table id="table_main" class="table_main" align="left" style="border: 0px;width:100%;">
			<tr>
				<td style="padding-left: 50px;">
				<h3 class="main_menu" style="text-indent: 0;">Engineer Page</h3>
				<br>
					<table style="width:90%;">

          <tr style="display: none;">
          <td class="head_top">IPv4/IPv6 Mode</td>
          <td class="tail_top">
          <select name="ip_mode" id="ip_mode" >
          <option value="2">IPv4/IPv6</option>
          <option selected value="0">IPv4</option>
          <option value="1">IPv6</option>
          </select>
          </td>
          </tr>
            <tr id="Wan_mtu">
            <td width="37%" class="head_top">WAN MTU</td>
            <td width="63%" class="tail_top">
                <input type="text" oncut="" oncopy="" onpaste="" name="input_wan_mtu" id="input_wan_mtu" MaxLength="16"/>
              <!-- <input id="button_mtu_apply" type="button"  value="Apply" /></td> -->
            </tr>

          <tr>
          <td class="head_top">RMnet Data </td>
          <td class="tail_top">
          <select name="rm_sw" id="rm_sw" >
          <option value="0">Disable</option>
          <option selected value="1">Enable</option>
          </select>
          </td>
          </tr>


					<tr>
					<td colspan ="3" class="head_top" id="errHint" style="padding:4px 20px 4px 20px;text-align:center;font-size:12px;FONT-FAMILY: Arial;color:red;">&nbsp;</td>
					</tr>

          <tr>
          <td colspan ="3" align="right">

            <button class="btn-Green"  id="submit_eng"><span><em>Apply</em></span></button>
            <button class="btn-Green" oncut="return false" oncopy="return false" onpaste="return false" onClick="load_setting(1)" ><span><em>Update</em></span></button>
          </td>
          </tr>
					</table>
<div>
          <h3 class="main_menu" style="text-indent:0" id="h3_dev_management">Device Management</h3>
        <br>
          <h4 id="h4_acs_url" class="small_menu" style="color:#515151; margin:0;">ACS URL Setting</h4>

        <table id="acs_sw" style="width:90%;">
          <tr>
              <td width="37%" class="head_top">ACS Disable</td>
              <td width="63%" class="tail_top">
                   <select name="acs_sw_type" id="acs_sw_type">
                      <option value="0">Disable</option>
                      <option value="1" selected="selected">Enable</option>
                  </select>
              </td>
          </tr>
        </table>


        <table id="table_acs_url" style="width:90%;">
          <tr id="tr_rm_type">
                        <td width="37%" class="head_top">RM Type</td>
                        <td width="63%" class="tail_top">
                             <select name="select_rm_type" id="select_rm_type" onchange="" >
                                <option value="1" selected="selected">TR-069</option>
                            </select>
                        </td>
          </tr>
          <tr id="tr_acs_url">
                        <td width="37%" class="head_top">ACS URL</td>
                        <td width="63%" class="tail_top">
                            <input name="input_acs_url" id="input_acs_url" type="text"  maxlength="230"/>
                        </td>
          </tr>
          <tr id="tr_acs_username">
                        <td width="37%" class="head_top">ACS User Name</td>
                        <td width="63%" class="tail_top">
                            <input name="input_acs_username" id="input_acs_username" type="text"  maxlength="32"/>
                        </td>
          </tr>
          <tr id="tr_acs_userpassword">
                        <td width="37%" class="head_top">ACS User Password</td>
                        <td width="63%" class="tail_top">
                            <input name="input_acs_userpassword" id="input_acs_userpassword" type="password"  maxlength="32"/>
                        </td>
          </tr>
          <tr id="tr_acs_periodic_inform">
                        <td width="37%" class="head_top">Periodic Inform</td>
                        <td width="63%" class="tail_top">
                             <select name="select_acs_periodic_inform" id="select_acs_periodic_inform" onchange="" >
                                <option value="1">Enable</option>
                                <option value="0" selected="selected">Disable</option>
                            </select>
                        </td>
          </tr>
          <tr id="tr_periodic_informinterval">
                        <td width="37%" class="head_top">Periodic Inform Interval</td>
                        <td width="63%" class="tail_top">
                            <input name="input_periodic_informinterval" id="input_periodic_informinterval" type="text" />SEC
                        </td>
          </tr>
          <tr id="tr_request_username">
                        <td width="37%" class="head_top">Request User Name</td>
                        <td width="63%" class="tail_top">
                            <input name="input_request_username" id="input_request_username" type="text"  maxlength="32"/>
                        </td>
          </tr>
          <tr id="tr_request_userpassword">
                        <td width="37%" class="head_top">Request User Password</td>
                        <td width="63%" class="tail_top">
                            <input name="input_request_userpassword" id="input_request_userpassword" type="password"  maxlength="32"/>
                        </td>
          </tr>
            <tr>
                        <td colspan ="3" align="right">
                        <button class="btn-Green"  id="button_acs"><span><em>Save</em></span></button>
                        </td>
          </tr>
        </table>


<table style="width:90%;margin-top: 10px;">
          <tr>
          <td width="37%" class="head_top">Adb Port</td>
          <td width="63%" class="tail_top" id="adb_st" style="text-indent: 11px;">
              Disabled
          </td>
          </tr>
          <tr>
          <td colspan ="3" align="right">
            <button class="btn-Green"  id="open_adb"><span><em>Open</em></span></button>
            <button class="btn-Green" oncut="return false" oncopy="return false" onpaste="return false" onClick="load_setting(4)" ><span><em>Update</em></span></button>
<!--           <input type="button" value = "Open" id= "open_adb">
          <input type="button" value = "Update" onClick="load_setting(4)"> -->
          </td>
          </tr>
</table>
<table style="width:90%;margin-top: 10px;">
          <tr style="margin-top:12px;">
          <td width="37%" class="head_top" style="margin-top:20px;">Diag Port</td>
          <td width="63%" class="tail_top" id="diag_st">
              Disabled
          </td>
          </tr>
          <tr>
          <td colspan ="3" align="right">
          <button class="btn-Green"  id="open_diag"><span><em>Open</em></span></button>
            <button class="btn-Green" oncut="return false" oncopy="return false" onpaste="return false" onClick="load_setting(12)" ><span><em>Update</em></span></button>

<!--           <input type="button" value = "Open" id= "open_diag">
          <input type="button" value = "Update" onClick="load_setting(12)"> -->
          </td>
          </tr>

</table>

<table style="width:90%;margin-top: 10px;">
          <tr>
            <td width="37%" class="head_top">Save Log</td>
            <td width="63%" class="tail_top" style="font-size: 14px;padding-right: 50px;">
              <input type="radio" id="save_log_disable" name="log_st" value="0" checked/><label class="ui_radio" for="save_log_disable"></label><label for="save_log_disable" class="ml5">Disable</label>
              <input type="radio" id="save_log_enable" name="log_st" value="1" /><label class="ui_radio" for="save_log_enable"></label><label class="mr20 ml5" for="save_log_enable">Enable</label>
            </td>
          </tr>
          <tr>
            <td width="37%" class="head_top">Sdcard Status</td>
            <td width="63%" class="tail_top" id="sd_status" style="font-size: 14px;padding-right: 50px;">
              SD card not exist!
            </td>
          </tr>
          <tr>
          <td colspan ="3" align="right">
          <button class="btn-Green"  id="save_log_submit"><span><em>Apply</em></span></button>
            <button class="btn-Green" oncut="return false" oncopy="return false" onpaste="return false" onClick="load_setting(16)" ><span><em>Update</em></span></button>

<!--           <input type="button" value = "Open" id= "open_diag">
          <input type="button" value = "Update" onClick="load_setting(12)"> -->
          </td>
          </tr>

</table>




          </div>

     </td>
     </tr>
     </table>
     <input id="csrf_token2" type="hidden" value="<% get_csrf_token(); %>">
<script>
if(top.location.pathname!="/index.htm") top.location.href="./index.htm";
$(document).ready(function() {

});

//MD5
var hexcase = 0;
var b64pad  = "";
var chrsz   = 8;
function hex_md5(s){ return binl2hex(core_md5(str2binl(s), s.length * chrsz));}
function b64_md5(s){ return binl2b64(core_md5(str2binl(s), s.length * chrsz));}
function str_md5(s){ return binl2str(core_md5(str2binl(s), s.length * chrsz));}
function hex_hmac_md5(key, data) { return binl2hex(core_hmac_md5(key, data)); }
function b64_hmac_md5(key, data) { return binl2b64(core_hmac_md5(key, data)); }
function str_hmac_md5(key, data) { return binl2str(core_hmac_md5(key, data)); }

function md5_vm_test(){
  return hex_md5("abc") == "900150983cd24fb0d6963f7d28e17f72";
}

function core_md5(x, len)
{
  x[len >> 5] |= 0x80 << ((len) % 32);
  x[(((len + 64) >>> 9) << 4) + 14] = len;

  var a =  1732584193;
  var b = -271733879;
  var c = -1732584194;
  var d =  271733878;

  for(var i = 0; i < x.length; i += 16)
  {
    var olda = a;
    var oldb = b;
    var oldc = c;
    var oldd = d;

    a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);
    d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);
    c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);
    b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);
    a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);
    d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);
    c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);
    b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);
    a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);
    d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);
    c = md5_ff(c, d, a, b, x[i+10], 17, -42063);
    b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);
    a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);
    d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);
    c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);
    b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);

    a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);
    d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);
    c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);
    b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);
    a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);
    d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);
    c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);
    b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);
    a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);
    d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);
    c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);
    b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);
    a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);
    d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);
    c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);
    b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);

    a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);
    d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);
    c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);
    b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);
    a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);
    d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);
    c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);
    b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);
    a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);
    d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);
    c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);
    b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);
    a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);
    d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);
    c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);
    b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);

    a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);
    d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);
    c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);
    b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);
    a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);
    d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);
    c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);
    b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);
    a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);
    d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);
    c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);
    b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);
    a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);
    d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);
    c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);
    b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);

    a = safe_add(a, olda);
    b = safe_add(b, oldb);
    c = safe_add(c, oldc);
    d = safe_add(d, oldd);
  }
  return Array(a, b, c, d);
}
function md5_cmn(q, a, b, x, s, t)
{
  return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s),b);
}
function md5_ff(a, b, c, d, x, s, t)
{
  return md5_cmn((b & c) | ((~b) & d), a, b, x, s, t);
}
function md5_gg(a, b, c, d, x, s, t)
{
  return md5_cmn((b & d) | (c & (~d)), a, b, x, s, t);
}
function md5_hh(a, b, c, d, x, s, t)
{
  return md5_cmn(b ^ c ^ d, a, b, x, s, t);
}
function md5_ii(a, b, c, d, x, s, t)
{
  return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);
}
function core_hmac_md5(key, data)
{
  var bkey = str2binl(key);
  if(bkey.length > 16) bkey = core_md5(bkey, key.length * chrsz);

  var ipad = Array(16), opad = Array(16);
  for(var i = 0; i < 16; i++)
  {
    ipad[i] = bkey[i] ^ 0x36363636;
    opad[i] = bkey[i] ^ 0x5C5C5C5C;
  }

  var hash = core_md5(ipad.concat(str2binl(data)), 512 + data.length * chrsz);
  return core_md5(opad.concat(hash), 512 + 128);
}

function safe_add(x, y)
{
  var lsw = (x & 0xFFFF) + (y & 0xFFFF);
  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);
  return (msw << 16) | (lsw & 0xFFFF);
}
function bit_rol(num, cnt)
{
  return (num << cnt) | (num >>> (32 - cnt));
}

function transalte_key(key){
   var result="";
   for(i in key){
    var n=parseInt(key[i],16);
    if(n>=0 && n<16) result+=keyss[n];
    else result+=keyss[15];
   }
   return result;
}

function str2binl(str)
{
  var bin = Array();
  var mask = (1 << chrsz) - 1;
  for(var i = 0; i < str.length * chrsz; i += chrsz)
    bin[i>>5] |= (str.charCodeAt(i / chrsz) & mask) << (i%32);
  return bin;
}

function binl2str(bin)
{
  var str = "";
  var mask = (1 << chrsz) - 1;
  for(var i = 0; i < bin.length * 32; i += chrsz)
    str += String.fromCharCode((bin[i>>5] >>> (i % 32)) & mask);
  return str;
}

function binl2hex(binarray)
{
  var hex_tab = hexcase ? "0123456789ABCDEF" : "0123456789abcdef";
  var str = "";
  for(var i = 0; i < binarray.length * 4; i++)
  {
    str += hex_tab.charAt((binarray[i>>2] >> ((i%4)*8+4)) & 0xF) +
           hex_tab.charAt((binarray[i>>2] >> ((i%4)*8  )) & 0xF);
  }
  return str;
}

var keyss="3@S35F@JmTQt9S#I";

/*
 * Convert an array of little-endian words to a base-64 string
 */
function binl2b64(binarray)
{
  var tab = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
  var str = "";
  for(var i = 0; i < binarray.length * 4; i += 3)
  {
    var triplet = (((binarray[i   >> 2] >> 8 * ( i   %4)) & 0xFF) << 16)
                | (((binarray[i+1 >> 2] >> 8 * ((i+1)%4)) & 0xFF) << 8 )
                |  ((binarray[i+2 >> 2] >> 8 * ((i+2)%4)) & 0xFF);
    for(var j = 0; j < 4; j++)
    {
      if(i * 8 + j * 6 > binarray.length * 32) str += b64pad;
      else str += tab.charAt((triplet >> 6*(3-j)) & 0x3F);
    }
  }
  return str;
}





function IsURL(str_url){
str_url=str_url.toLowerCase();
//str_url="https://iotacs.jioconnect.com:8443/ftacs-digest/ACS";
var strRegex = "^((https|http|ftp|rtsp|mms)?://)"
+ "?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?"
+ "(([0-9]{1,3}.){3}[0-9]{1,3}"
+ "|"
+ "\\[((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\\]"
+ "|"
+ "([0-9a-z_!~*'()-]+.)*"
+ "([0-9a-z][0-9a-z-]{0,61})?[0-9a-z]."
+ "[a-z]{2,6})" // first level domain- .com or .museum
+ "(:[0-9]{1,5})?" //
+ "((/?)|" // a slash isn't required if there is no file name
+ "(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$";
var re=new RegExp(strRegex);
//re.test()
if (re.test(str_url)){
return (true);
}else{
return (false);
}
}

function isNumber(str){
var reg=new RegExp("^[1-9][0-9]*$");
if (reg.test(str)){
return (true);
}else{
return (false);
}
}



$("#acs_sw_type").die().live('change',function(){
  if(!parseInt($(this).val())){
    $("#table_acs_url").hide();
  var headers={};
  headers["__RequestVerificationToken"]=$("#csrf_token2").val();

    show_tips(seed,"Waiting...");
      $.ajax({
      url: "/wxml/disable_acs.xml",
      type: "Post",
      headers: headers,
      timeout: 8000,
      cache: false,
      datatype: "xml",
      data: {"disable": "1"},
      success: function(data, status) {
        var new_token=$(data).find("token").text();
      if(new_token=="-1"){
        top.location.reload(true);
        return false;
      }
        $("#csrf_token2").val(new_token);
        hide_tips(seed);
        var ret0 = parseInt($(data).find("disable").text());
        if(ret0) alert('Setting Apply Success!');
        else alert('Setting Apply Fail!');
        load_setting(2);
      },
      error: function(x, t, m){
        hide_tips(seed);
        if(t==="timeout"){

        }
      }
    })
  }
  else{
    confirm("Enable ACS will cause device reboot, do you want to continue?",function(){
  var headers={};
  headers["__RequestVerificationToken"]=$("#csrf_token2").val();

       show_tips(seed,"Waiting...");
      $.ajax({
      url: "/wxml/reboot.xml",
      type: "Post",
      headers: headers,
      timeout: 8000,
      cache: false,
      datatype: "xml",
      data: {"reboot": "1"},
      success: function(data, status) {

      },
      error: function(x, t, m){
        hide_tips(seed);
        $("#acs_sw_type").val(0);
      reload_compnets(seed);
      return false;
        if(t==="timeout"){

        }
      }
    })
    },function(){
      $("#acs_sw_type").val(0);
      reload_compnets(seed);
      return false;
    });
  }
})



var diag_sw=0;

$('#open_adb').die().live('click',function(event){
  event.preventDefault();
  if(!$("#adb_key").val().length){
    alert("please input key");
    $("#adb_key").focus();
    return;
  }

  var ori_key=hex_md5($("#adb_key").val());

  ori_key=ori_key.substr(5,17);

  var key=transalte_key(ori_key);

  var headers={};
  headers["__RequestVerificationToken"]=$("#csrf_token2").val();
    show_tips(seed,"Waiting...");
    $.ajax({
      url: "/wxml/open_port.xml",
      type: "Post",
      headers: headers,
      timeout: 8000,
      cache: false,
      datatype: "xml",
      data: {"adb_sw": "1","adb_key": key },
      success: function(data, status) {
        var new_token=$(data).find("token").text();
      if(new_token=="-1"){
        top.location.reload(true);
        return false;
      }
        $("#csrf_token2").val(new_token);
        hide_tips(seed);
        var ret0 = parseInt($(data).find("adb").text());
        if(ret0) alert('Setting Apply Success!');
        else alert('Setting Apply Fail!');
        load_setting(4);
      },
      error: function(x, t, m){
        hide_tips(seed);
        if(t==="timeout"){

        }
      }
    })

})

$('#save_log_submit').die().live('click',function(event){
    event.preventDefault();
    var headers={};
    headers["__RequestVerificationToken"]=$("#csrf_token2").val();
    show_tips(seed,"Waiting...");
    var save =  $('input[name=log_st]:checked').val();
    $.ajax({
      url: "/wxml/set_log_save.xml",
      type: "Post",
      headers: headers,
      timeout: 8000,
      cache: false,
      datatype: "xml",
      data: {"save": save },
      success: function(data, status) {
        var new_token = $(data).find("token").text();
        if(new_token == "-1") {
          top.location.reload(true);
          return false;
        }
        $("#csrf_token2").val(new_token);
        locking = 0;
        hide_tips(seed);
        var ret = parseInt($(data).find("set_log").text());
        if(ret) alert('Setting Apply Success!');
        else alert('Setting Apply Fail!');
        load_setting(16);
      },
      error: function(x, t, m){
        hide_tips(seed);
        if(t==="timeout"){

        }
      }
    });

})



$('#open_diag').die().live('click',function(event){
  event.preventDefault();

  // if(!confirm("Open/Close Diag port will cause device reboot, do you want to continue?")){
  //   return;
  // }
    if(!$("#diag_key").val().length){
    alert("please input key");
    $("#diag_key").focus();
    return;
  }

confirm("Open/Close Diag port will cause device reboot, do you want to continue?",function(){

  $(this).removeAttr("disabled").removeClass("disabled");

  var ori_key=hex_md5($("#diag_key").val());
  ori_key=ori_key.substr(5,17)
  var key=transalte_key(ori_key);
  var headers={};
  headers["__RequestVerificationToken"]=$("#csrf_token2").val();
    show_tips(seed,"Waiting...");
    $.ajax({
      url: "/wxml/open_port.xml",
      type: "Post",
      headers: headers,
      timeout: 8000,
      cache: false,
      datatype: "xml",
      data: {"diag_sw": diag_sw?0:1,"diag_key": key },
      success: function(data, status) {
        var new_token=$(data).find("token").text();
      if(new_token=="-1"){
        top.location.reload(true);
        return false;
      }
        $("#csrf_token2").val(new_token);
        hide_tips(seed);
        var ret0 = parseInt($(data).find("diag").text());
        if(ret0) alert('Setting Apply Success!');
        else alert('Setting Apply Fail!');
        load_setting(12);
      },
      error: function(x, t, m){
        hide_tips(seed);
        if(t==="timeout"){

        }
      }
    });
    setTimeout(function(){top.location.reload(true)},8000);
},function(){});
})




$('#button_acs').die().live('click',function(event){
  event.preventDefault();

var acs_url=$("#input_acs_url").val();
var acs_username=$("#input_acs_username").val();
var acs_pwd=$("#input_acs_userpassword").val();
var inform=$("#select_acs_periodic_inform").val();
var interval=$("#input_periodic_informinterval").val();
var req_username=$("#input_request_username").val();
var req_pwd=$("#input_request_userpassword").val();


  if ($("#input_acs_url").val().length < 9) {
    alert("Enter 9 or more characters for the ACS URL.");
    return false;
  }

if (!IsURL($("#input_acs_url").val())) {
    alert("Please input correct URL");
    return false;
  }






if(!isNumber(interval) || interval<1 || interval>4294967295){
  alert("Please input integer number [1,4294967295]");
  $("#input_periodic_informinterval").focus();
  return false;
}

  var post_data='stop=1'+'&acs_url='+esc(acs_url)+'&acs_username='+esc(acs_username)+'&acs_pwd='+esc(acs_pwd)+'&inform='+esc(inform)+'&interval='+esc(""+interval)+'&req_username='+esc(req_username)+'&req_pwd='+esc(req_pwd)+'&restart=1';
  var headers={};
  headers["__RequestVerificationToken"]=$("#csrf_token2").val();
    show_tips(seed,"Waiting...");
    $.ajax({
      url: "/wxml/set_tr.xml",
      type: "Post",
      headers: headers,
      timeout: 8000,
      cache: false,
      datatype: "xml",
      data: post_data,
      success: function(data, status) {
        var new_token=$(data).find("token").text();
      if(new_token=="-1"){
        top.location.reload(true);
        return false;
      }
        $("#csrf_token2").val(new_token);
        hide_tips(seed);
        var ret0 = parseInt($(data).find("acs_url").text());
        var ret1 = parseInt($(data).find("acs_username").text());
        var ret2 = parseInt($(data).find("acs_pwd").text());
        var ret3 = parseInt($(data).find("inform").text());
        var ret4 = parseInt($(data).find("interval").text());
        var ret5 = parseInt($(data).find("req_username").text());
        var ret6 = parseInt($(data).find("req_pwd").text());
        if(ret0&& ret1&& ret2&& ret3 &&ret4 &&ret5 &&ret6) alert('Setting Apply Success!');
        else alert('Setting Apply Fail!');
        load_setting(2);
      },
      error: function(x, t, m){
        hide_tips(seed);
        if(t==="timeout"){

        }
      }
    })

//  pop_submit_result();
});


function refresh_data(data,mask){
  if(mask&0x01){
    var ip_mode=parseInt($(data).find("ip_mode").text());
    var mtu=parseInt($(data).find("mtu").text());
    var rm_sw=parseInt($(data).find("rm_sw").text());
    if(mtu==0) mtu=1500;
//    $('select[name=ip_mode]').val(ip_mode);
    $('#input_wan_mtu').val(mtu);
    $('select[name=rm_sw]').val(rm_sw);

  }
  if(mask&0x02){
    var acssw  = $(data).find("acssw").text();

    $("#acs_sw_type").val(acssw);
    if(!parseInt(acssw)){
      $("#table_acs_url").hide();
    }
    else{
      $("#table_acs_url").show();
    }

    var acsurl  = $(data).find("acsurl").text();
    var acs_username  = $(data).find("acs_username").text();
    var acs_password  = $(data).find("acs_password").text();
    var periodic_inform  = $(data).find("periodic_inform").text();
    var informinterval  = $(data).find("informinterval").text();
    var request_username  = $(data).find("request_username").text();
    var request_userpassword  = $(data).find("request_userpassword").text();


    $("#input_acs_url").val(acsurl=='-'?'':acsurl );
    $("#input_acs_username").val(acs_username=='-'?'':acs_username);
    $("#input_acs_userpassword").val(acs_password=='-'?'':acs_password);
    $("#select_acs_periodic_inform").val(periodic_inform=='-'?'0':periodic_inform);
    $("#input_periodic_informinterval").val(informinterval=='-'?'':informinterval);
    $("#input_request_username").val(request_username=='-'?'':request_username);
    $("#input_request_userpassword").val(request_userpassword=='-'?'':request_userpassword);
  }
  if(mask&0x04){
    var adb  = parseInt($(data).find("adb").text());
    if(!adb){
      $("#adb_st").html("<input type=\"password\" id=\"adb_key\">");
      $("#open_adb").removeAttr("disabled").removeClass("disabled");
    }
    else{
      $("#adb_st").html("Enabled");
      $("#open_adb").attr("disabled", true).addClass("disabled");;
    }

  }
  if(mask&0x08){
    var diag  = parseInt($(data).find("diag").text());
    diag_sw=diag;
    if(!diag){
      $("#diag_st").html("<input type=\"password\" id=\"diag_key\">");
      $("#open_diag").attr({"value":'Open'});
    }
    else{
      $("#diag_st").html("<input type=\"password\" id=\"diag_key\">");
      $("#open_diag").attr({"value":'Close'});
    }
  }
  if(mask&0x10){
    var sd_st  = parseInt($(data).find("sd_st").text());
    var sd_mode  = parseInt($(data).find("sd_mode").text());
    var log_st  = parseInt($(data).find("log_st").text());
    $('input[name=log_st]').eq(log_st).attr('checked', 'checked');
    if(sd_st==0){
     $("#sd_status").html("SD card not exist"); 
    }
    else if(sd_mode!=1){
      $("#sd_status").html("SD card is not wifi storage mode");
    }
    else{
      if(log_st) $("#sd_status").html("SD card save log enabled");
      else $("#sd_status").html("SD card save log disabled");
    }

    if(sd_mode==1 && sd_st!=0){
      $('#save_log_submit').removeAttr("disabled").removeClass("disabled");      
    }
    else $('#save_log_submit').attr("disabled", true).addClass("disabled");
  }
}

function load_setting(mask){

  $.ajax({
    url: "mark_set_test.w.xml",
    type: "Get",
    timeout: 8000,
    cache: false,
    datatype: "xml",
//    data: { path:curr_path,page:curr_page,filter:'255'  },
    success: function(data, status) {
      refresh_data(data,mask);
      reload_compnets(seed);
    },
    error: function(x, t, m){
      if(t==="timeout"){

      }
    }
  })
}

function load_mark(url){
if(interval_timer) clearInterval(interval_timer);
  if(url=="engineer.html"){
    load_setting(31);
  }
}



$('#submit_eng').die().live('click',function(event){
  event.preventDefault();

//  var ip_mode = $('select[name=ip_mode]').val();
  var rm_sw = $('select[name=rm_sw]').val();
  var mtu = $('#input_wan_mtu').val();
  if ($("#input_wan_mtu").val().match(/[^0-9]/)) {
  $("#input_wan_mtu").focus();
    alert("Enter only numbers for the MTU value.");
    return true;
  }

  if (($("#input_wan_mtu").val() < 1280) || ($("#input_wan_mtu").val() > 1500))
  {
      alert("Enter a value between 1280 and 1500 the MTU value.");
      $("#input_wan_mtu").focus();
      return true;
  }

  show_tips(seed,"Waiting...");
//  var post_data= 'ip_mode='+esc(ip_mode)+'&mtu='+esc(mtu)+'&rm_sw='+esc(rm_sw);
var post_data= 'mtu='+esc(mtu)+'&rm_sw='+esc(rm_sw);
  $("#errHint").html('');
  var headers={};
  headers["__RequestVerificationToken"]=$("#csrf_token2").val();
    $.ajax({
      url: "/wxml/set_test.xml",
      type: "Post",
      headers: headers,
      timeout: 8000,
      cache: false,
      datatype: "xml",
      data: post_data,
      success: function(data, status) {
        var new_token=$(data).find("token").text();
      if(new_token=="-1"){
        top.location.reload(true);
        return false;
      }
        $("#csrf_token2").val(new_token);
        hide_tips(seed);
//        var ret0 = parseInt($(data).find("ip_mode").text());
        var ret1 = parseInt($(data).find("mtu").text());
        var ret2 = parseInt($(data).find("rm_sw").text());
        if(ret1 && (ret2==1)) $('#errHint').html('Setting Apply Success!');
        else $('#errHint').html('Setting Apply Fail!');
        load_setting(1);
        setTimeout(function(){
          $("#errHint").html('&nbsp;');
        },5000);
      },
      error: function(x, t, m){
        hide_tips(seed);
        if(t==="timeout"){

        }
      }
    })

//  pop_submit_result();
});
</script>

<!-- </html> -->
